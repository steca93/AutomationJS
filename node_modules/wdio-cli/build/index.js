'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.run = undefined;

var _sourceMapSupport2 = require('source-map-support');

var _yargs = require('yargs');

var _yargs2 = _interopRequireDefault(_yargs);

var _lodash = require('lodash.pickby');

var _lodash2 = _interopRequireDefault(_lodash);

var _config = require('./config');

var _launcher = require('./launcher');

var _launcher2 = _interopRequireDefault(_launcher);

var _run = require('./run');

var _run2 = _interopRequireDefault(_run);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

(0, _sourceMapSupport2.install)();
const run = exports.run = () => {
    let argv = _yargs2.default.usage(_config.USAGE).commandDir('commands');

    /**
     * populate cli arguments
     */
    var _iteratorNormalCompletion = true;
    var _didIteratorError = false;
    var _iteratorError = undefined;

    try {
        for (var _iterator = _config.CLI_PARAMS[Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {
            const param = _step.value;

            argv = argv.option(param.name, param);
        }
    } catch (err) {
        _didIteratorError = true;
        _iteratorError = err;
    } finally {
        try {
            if (!_iteratorNormalCompletion && _iterator.return) {
                _iterator.return();
            }
        } finally {
            if (_didIteratorError) {
                throw _iteratorError;
            }
        }
    }

    const params = (0, _lodash2.default)(argv.argv);

    /**
     * fail execution if more than one wdio config file was specified
     */
    if (params._.length > 1) {
        argv.showHelp();
        console.error(`More than one config file was specified: ${params._.join(', ')}`); // eslint-disable-line
        console.error('Error: You can only run one wdio config file!'); // eslint-disable-line
        process.exit(1);
    }

    (0, _run2.default)(params);
};

exports.default = _launcher2.default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJydW4iLCJhcmd2IiwieWFyZ3MiLCJ1c2FnZSIsIlVTQUdFIiwiY29tbWFuZERpciIsIkNMSV9QQVJBTVMiLCJwYXJhbSIsIm9wdGlvbiIsIm5hbWUiLCJwYXJhbXMiLCJfIiwibGVuZ3RoIiwic2hvd0hlbHAiLCJjb25zb2xlIiwiZXJyb3IiLCJqb2luIiwicHJvY2VzcyIsImV4aXQiLCJMYXVuY2hlciJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7Ozs7QUFDQTs7OztBQUVBOztBQUNBOzs7O0FBQ0E7Ozs7Ozs7QUFFTyxNQUFNQSxvQkFBTSxNQUFNO0FBQ3JCLFFBQUlDLE9BQU9DLGdCQUNOQyxLQURNLENBQ0FDLGFBREEsRUFFTkMsVUFGTSxDQUVLLFVBRkwsQ0FBWDs7QUFJQTs7O0FBTHFCO0FBQUE7QUFBQTs7QUFBQTtBQVFyQiw2QkFBb0JDLGtCQUFwQiw4SEFBZ0M7QUFBQSxrQkFBckJDLEtBQXFCOztBQUM1Qk4sbUJBQU9BLEtBQUtPLE1BQUwsQ0FBWUQsTUFBTUUsSUFBbEIsRUFBd0JGLEtBQXhCLENBQVA7QUFDSDtBQVZvQjtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOztBQVlyQixVQUFNRyxTQUFTLHNCQUFPVCxLQUFLQSxJQUFaLENBQWY7O0FBRUE7OztBQUdBLFFBQUlTLE9BQU9DLENBQVAsQ0FBU0MsTUFBVCxHQUFrQixDQUF0QixFQUF5QjtBQUNyQlgsYUFBS1ksUUFBTDtBQUNBQyxnQkFBUUMsS0FBUixDQUFlLDRDQUEyQ0wsT0FBT0MsQ0FBUCxDQUFTSyxJQUFULENBQWMsSUFBZCxDQUFvQixFQUE5RSxFQUZxQixDQUU0RDtBQUNqRkYsZ0JBQVFDLEtBQVIsQ0FBYywrQ0FBZCxFQUhxQixDQUcwQztBQUMvREUsZ0JBQVFDLElBQVIsQ0FBYSxDQUFiO0FBQ0g7O0FBRUQsdUJBQU9SLE1BQVA7QUFDSCxDQXpCTTs7a0JBMkJRUyxrQiIsImZpbGUiOiJpbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB5YXJncyBmcm9tICd5YXJncydcbmltcG9ydCBwaWNrQnkgZnJvbSAnbG9kYXNoLnBpY2tieSdcblxuaW1wb3J0IHsgQ0xJX1BBUkFNUywgVVNBR0UgfSBmcm9tICcuL2NvbmZpZydcbmltcG9ydCBMYXVuY2hlciBmcm9tICcuL2xhdW5jaGVyJ1xuaW1wb3J0IHJ1bkNMSSBmcm9tICcuL3J1bidcblxuZXhwb3J0IGNvbnN0IHJ1biA9ICgpID0+IHtcbiAgICBsZXQgYXJndiA9IHlhcmdzXG4gICAgICAgIC51c2FnZShVU0FHRSlcbiAgICAgICAgLmNvbW1hbmREaXIoJ2NvbW1hbmRzJylcblxuICAgIC8qKlxuICAgICAqIHBvcHVsYXRlIGNsaSBhcmd1bWVudHNcbiAgICAgKi9cbiAgICBmb3IgKGNvbnN0IHBhcmFtIG9mIENMSV9QQVJBTVMpIHtcbiAgICAgICAgYXJndiA9IGFyZ3Yub3B0aW9uKHBhcmFtLm5hbWUsIHBhcmFtKVxuICAgIH1cblxuICAgIGNvbnN0IHBhcmFtcyA9IHBpY2tCeShhcmd2LmFyZ3YpXG5cbiAgICAvKipcbiAgICAgKiBmYWlsIGV4ZWN1dGlvbiBpZiBtb3JlIHRoYW4gb25lIHdkaW8gY29uZmlnIGZpbGUgd2FzIHNwZWNpZmllZFxuICAgICAqL1xuICAgIGlmIChwYXJhbXMuXy5sZW5ndGggPiAxKSB7XG4gICAgICAgIGFyZ3Yuc2hvd0hlbHAoKVxuICAgICAgICBjb25zb2xlLmVycm9yKGBNb3JlIHRoYW4gb25lIGNvbmZpZyBmaWxlIHdhcyBzcGVjaWZpZWQ6ICR7cGFyYW1zLl8uam9pbignLCAnKX1gKSAvLyBlc2xpbnQtZGlzYWJsZS1saW5lXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yOiBZb3UgY2FuIG9ubHkgcnVuIG9uZSB3ZGlvIGNvbmZpZyBmaWxlIScpIC8vIGVzbGludC1kaXNhYmxlLWxpbmVcbiAgICAgICAgcHJvY2Vzcy5leGl0KDEpXG4gICAgfVxuXG4gICAgcnVuQ0xJKHBhcmFtcylcbn1cblxuZXhwb3J0IGRlZmF1bHQgTGF1bmNoZXJcbiJdfQ==